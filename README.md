# Ethereum-Smart-Contract-Automated-Vulnerability-Detection-and-Verification-Tool

## - Install dependencies

`yarn add --dev @nomiclabs/hardhat-ethers@npm:hardhat-deploy-ethers ethers @nomiclabs/hardhat-etherscan @nomiclabs/hardhat-waffle chai ethereum-waffle hardhat hardhat-contract-sizer hardhat-deploy hardhat-gas-reporter prettier prettier-plugin-solidity solhint solidity-coverage dotenv`

## `fetch_blockchain_data_scripts.js`

在这个示例中，我们使用了一个空的数组 `contractData` 来保存获取到的所有合约的信息。在每个交易中，我们首先检查交易是否为合约创建交易。如果是，我们使用 `ethers.ContractFactory`来解析合约字节码并获取合约 ABI，并且通过`provider.getCode()`的方法获得字节码。然后将所有信息添加到 `contractData`数组中。
如果交易不是合约创建交易，我们检查交易目标地址是否为合约地址，如果是，我们使用 ethers.Contract 对象连接到该地址，并使用 `interface` 属性来获取合约 `ABI`，然后将所有信息添加到 `contractData` 数组中。

 最后，我们使用 `fs.writeFileSync` 方法将 `contractData` 数组中的信息保存到一个 JSON 文件中。输出文件的格式化选项是 `null, 2`，这将在文件中使用两个空格来缩进每个对象的属性。在输出文件后，程序会在控制台上输出一条消息。

## 2.24

将`contractData.json`中的array的`bytecode`的部分单独拿出来。
在这个例子中，我们首先读取 `contractData.json` 文件，并使用 `JSON.parse` 方法将其解析为一个对象数组。然后，我们使用 `map` 方法对数组中的每个元素进行处理，提取其中的 `bytecode` 字段的值，并将所有值存储到一个新的数组中。最后，我们将新的数组输出到`typecodeData.json`中,为使用`slither`工具的做准备。
现在需要知道如何使用这个`hslither`工具。

### 安装

创建python的虚拟环境`gp`，
`conda activate gp`
`pip3 install slither-analyzer`

## 2.25

`yarn add slither-js --dev`
:imp: :imp: 假的 :imp: :imp:

试着安装`slither`，根本用不来，吐了。
了解了一下后续工作要具体怎么做感觉大方向感觉没什么问题，但是在细节部分问题可能会有很多

## 2.26

在`powershell`上用`slither .`这个命令竟然又行了？行吧。

```powershell
Different versions of Solidity are used:
        - Version used: ['^0.8.0', '^0.8.7']
        - ^0.8.0 (node_modules/@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol#2)
        - ^0.8.7 (contracts/Lock.sol#3)
        - ^0.8.7 (contracts/PriceConverter.sol#2)
Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#different-pragma-directives-are-used

Pragma version^0.8.0 (node_modules/@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol#2) allows old versions
Pragma version^0.8.7 (contracts/Lock.sol#3) allows old versions
Pragma version^0.8.7 (contracts/PriceConverter.sol#2) allows old versions
solc-0.8.17 is not recommended for deployment
Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#incorrect-versions-of-solidity

Low level call in FundMe.withdraw() (contracts/Lock.sol#62-76):
        - (success) = i_owner.call{value: address(this).balance}() (contracts/Lock.sol#74)
Low level call in FundMe.cheaperWithdraw() (contracts/Lock.sol#78-93):
        - (success) = i_owner.call{value: address(this).balance}() (contracts/Lock.sol#91)
Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#low-level-calls

Variable FundMe.i_owner (contracts/Lock.sol#22) is not in mixedCase
Variable FundMe.s_funders (contracts/Lock.sol#23) is not in mixedCase
Variable FundMe.s_addressToAmountFunded (contracts/Lock.sol#24) is not in mixedCase
Variable FundMe.s_priceFeed (contracts/Lock.sol#25) is not in mixedCase
Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#conformance-to-solidity-naming-conventions

PriceConverter.getPrice(AggregatorV3Interface) (contracts/PriceConverter.sol#7-15) uses literals with too many digits:
        - uint256(answer * 10000000000) (contracts/PriceConverter.sol#14)
PriceConverter.getConversionRate(uint256,AggregatorV3Interface) (contracts/PriceConverter.sol#20-28) uses literals with too many digits:
        - ethAmountInUsd = (ethPrice * ethAmount) / 1000000000000000000 (contracts/PriceConverter.sol#25)
Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#too-many-digits

FundMe.s_priceFeed (contracts/Lock.sol#25) should be immutable
Reference: https://github.com/crytic/slither/wiki/Detector-Documentation#state-variables-that-could-be-declared-immutable
. analyzed (3 contracts with 84 detectors), 14 result(s) found
```

那接下来我需要安装`solc`的版本控制工具了。预祝接下来的我一切顺利。 :smile:

## 2.27

安装`Mythril`
`pip3 install mythril`

```bash
myth analyze <solidity-file>
```

Or:

```bash
myth analyze -a <contract-address>
```
