const fs = require("fs")
const { exec } = require("child_process")

// 读取json文件
const data = fs.readFileSync("./contract_data/contractData.json")
const contracts = JSON.parse(data)
const cmd =
    "docker run --rm -v D:CodeJS-SolidityGraduation_Projectcontract_data:/data trailofbits/eth-security-toolbox"
for (const contract of contracts) {
    const address = contract.address
    const bytecode = contract.bytecode
    const result = exec(
        //`docker run -v ${contract.path}:/contract trailofbits/slither /contract/${contract.filename}`,
        cmd,

        (error, stdout, stderr) => {
            if (error) {
                console.error(`执行出错: ${error}`)
                return
            }
            // 处理检测结果
            console.log(`stdout: ${stdout}`)
            console.error(`stderr: ${stderr}`)
        }
    )
}
